# Carpooling server

Приложение для организации совместных поездок с использованием FastAPI и PostgreSQL.

## Требования

- Python 3.8+ (рекомендуется Python 3.12)
- PostgreSQL 12+
- pip (менеджер пакетов Python)

## Основные зависимости

- FastAPI >= 0.68.0 - современный веб-фреймворк
- SQLAlchemy >= 1.4.23 - ORM для работы с базой данных
- Pydantic >= 2.0.0 - валидация данных
- uvicorn >= 0.15.0 - ASGI сервер
- psycopg2-binary >= 2.9.1 - драйвер PostgreSQL
- passlib >= 1.7.4 - хеширование паролей
- python-dotenv >= 0.19.0 - работа с переменными окружения
- email-validator >= 1.1.3 - валидация email адресов

## Локальная установка и запуск

### 1. Клонирование репозитория

```bash
git clone <url-репозитория>
cd carpooling-app
```

### 2. Создание виртуального окружения

```bash
python -m venv venv
```

Активация виртуального окружения:

**Windows:**

```bash
venv\Scripts\activate
```

**Linux/MacOS:**

```bash
source venv/bin/activate
```

### 3. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 4. Настройка базы данных

1. Установите и запустите PostgreSQL
2. Создайте базу данных:

```bash
createdb carpool-db
```

3. Скопируйте файл `.env.example` в `.env` и настройте переменные окружения:

```
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/carpool-db
PROJECT_NAME="Carpooling app"
```

#### Детали подключения к базе данных:

- `postgresql://` - протокол подключения к PostgreSQL
- `postgres` (первый) - имя пользователя базы данных (по умолчанию postgres)
- `postgres` (второй) - пароль пользователя базы данных
- `localhost` - хост, где запущен PostgreSQL сервер
- `5432` - стандартный порт PostgreSQL
- `carpool-db` - название базы данных

Для изменения параметров подключения:

1. Измените имя пользователя базы данных (первый `postgres`)
2. Измените пароль (второй `postgres`)
3. Если PostgreSQL запущен на другом сервере, замените `localhost` на IP-адрес
4. Если PostgreSQL использует нестандартный порт, замените `5432`
5. При необходимости измените название базы данных (`carpool-db`)

### 5. Запуск сервера

```bash
uvicorn app.main:app --reload
```

После запуска сервер будет доступен по адресу: http://localhost:8000

API документация будет доступна по адресу: http://localhost:8000/docs

## Структура проекта

```
app/
├── api/                 # API endpoints
│   └── endpoints/      # Модули с маршрутами
├── crud/               # CRUD операции
├── models/             # SQLAlchemy модели
├── schemas/            # Pydantic схемы
└── utils/              # Вспомогательные функции
```

## Основные функции

- Управление пользователями (регистрация, авторизация)
- Создание и управление поездками
- Система бронирования
- Чат между участниками поездки
- Управление избранными местами
- Система ролей (водитель/пассажир)
- Бонусная система (carbon bonus points)

## API Endpoints

- `/api/users` - управление пользователями
- `/api/rides` - управление поездками
- `/api/bookings` - управление бронированиями
- `/api/chat` - система сообщений
- `/api/favourite-places` - избранные места
- `/api/roles` - управление ролями

## Дополнительная информация

- Для остановки сервера нажмите: Ctrl+C
- Для деактивации виртуального окружения используйте команду: `deactivate`
- Подробная документация по разработке доступна в файле `INSTRUCTION.md`

## Безопасность

- Пароли хешируются с использованием bcrypt
- Реализована базовая валидация данных через Pydantic
- Проверка ролей и прав доступа

## Разработка

Проект использует:

- SQLAlchemy для ORM
- FastAPI для API
- Pydantic для валидации данных
